version: "3.9"

services:
  lavalink:
    image: ghcr.io/lavalink-devs/lavalink:4-alpine
    container_name: lavalink
    restart: unless-stopped
    environment:
      # set Java options here (6GB heap size)
      - _JAVA_OPTIONS=-Xmx6G
      # set lavalink server port
      - SERVER_PORT=2333
      # set password for lavalink
      - LAVALINK_SERVER_PASSWORD=youshallnotpass
    volumes:
      - ./lavalink/application.yml:/opt/Lavalink/application.yml
      - ./lavalink/plugins/:/opt/Lavalink/plugins/

  ejs-api:
    # Uncomment to build locally
    # build:
    #   context: .
    #   dockerfile: Dockerfile
    image: ghcr.io/kikkia/yt-cipher:master
    container_name: ejs_signature_api
    ports:
      - "8001:8001"
    environment:
      - API_TOKEN=your_secret_password
    restart: unless-stopped

  molten-musicbot:
    build: .
    image: molten-musicbot:latest
    container_name: molten-musicbot
    environment:
      LAVALINK_HOST: lavalink
      LAVALINK_PORT: 2333
      LAVALINK_PASSWORD: youshallnotpass
      SSL_ENABLED: "false"
      LOG_LEVEL: "INFO" # INFO or DEBUG
    restart: unless-stopped
    volumes:
      - ./data:/app/data
